# =============================================================================
# Biya Indexer 环境变量配置
# 
# 使用方法:
#   1. 复制本文件: cp env.example .env
#   2. 根据实际环境修改配置
#   3. 启动服务: docker-compose -f docker-compose.all-in-one.yaml up -d
# =============================================================================

###############################
### 用户可配置区域 ###
###############################

# ===== 网络配置 =====
NETWORK=mainnet                    # 网络类型: mainnet / testnet
CHAIN_ID=biya-1                    # 链 ID

# ===== 应用配置 =====
APP_ENV=prod                       # 环境: prod / staging / dev
LOG_LEVEL=info                     # 日志级别: debug / info / warn / error

# ===== 数据路径 =====
# 所有服务的数据存储根目录
DATA_PATH=./data

# ===== 服务版本 =====
DRAGONFLY_VERSION=latest           # Dragonfly 版本
KAFKA_VERSION=7.5.0                # Kafka 版本
ZOOKEEPER_VERSION=7.5.0            # Zookeeper 版本
KAFKA_UI_VERSION=latest            # Kafka UI 版本
SCYLLA_VERSION=latest              # ScyllaDB 版本

# ===== Dragonfly (Redis 缓存) 配置 =====
DRAGONFLY_PORT=6379                # Redis 协议端口
DRAGONFLY_ADMIN_PORT=6380          # 管理端口
DRAGONFLY_MEMORY=2gb               # 最大内存使用
DRAGONFLY_THREADS=4                # 工作线程数（建议设为 CPU 核心数）

# ===== Kafka 配置 =====
KAFKA_PORT=9092                    # Kafka 外部端口
KAFKA_INTERNAL_PORT=29092          # Kafka 内部端口
KAFKA_AUTO_CREATE_TOPICS=true      # 自动创建 Topic
KAFKA_NUM_PARTITIONS=3             # 默认分区数
KAFKA_LOG_RETENTION_HOURS=168      # 日志保留时间（小时），默认 7 天

# ===== Zookeeper 配置 =====
ZOOKEEPER_PORT=2181                # Zookeeper 客户端端口

# ===== Kafka UI 配置（可选）=====
KAFKA_UI_PORT=8080                 # Kafka UI Web 端口

# ===== ScyllaDB 配置 =====
SCYLLA_CQL_PORT=9042               # CQL 协议端口
SCYLLA_REST_PORT=10000             # REST API 端口
SCYLLA_METRICS_PORT=9180           # Prometheus 指标端口
SCYLLA_SMP=2                       # CPU 核心数
SCYLLA_MEMORY=2G                   # 内存限制

# ===== 资源限制（可选）=====
# 以下配置用于限制服务资源使用，可根据实际情况调整
# DRAGONFLY_CPU_LIMIT=2
# DRAGONFLY_MEMORY_LIMIT=4G
# KAFKA_CPU_LIMIT=2
# KAFKA_MEMORY_LIMIT=4G
# SCYLLA_CPU_LIMIT=4
# SCYLLA_MEMORY_LIMIT=8G

###############################
### Indexer 服务配置 ###
###############################

# ===== 区块链节点连接 =====
INDEXER_CHAIN_RPC=http://localhost:26657     # 区块链 RPC 地址
INDEXER_CHAIN_GRPC=tcp://localhost:9090      # 区块链 gRPC 地址
INDEXER_CHAIN_LCD=http://localhost:1317      # 区块链 LCD 地址

# ===== 索引器配置 =====
INDEXER_START_HEIGHT=0             # 起始区块高度（0 表示从最新区块开始）
INDEXER_BLOCK_FETCH_JOBS=2         # 区块获取并发数
INDEXER_MAX_BLOCK_FETCH_JOBS=8     # 最大区块获取并发数
INDEXER_MIN_BLOCK_FETCH_JOBS=2     # 最小区块获取并发数

# ===== TLS 配置 =====
INDEXER_TLS_ENABLED=false          # 是否启用 TLS

###############################
### 以下配置通常无需修改 ###
###############################

# ===== 内部服务连接 =====
# 这些配置由 docker-compose 自动设置，一般不需要修改
SCYLLA_HOSTS=scylla:9042
KAFKA_BROKERS=kafka:29092
REDIS_URL=dragonfly:6379
ZOOKEEPER_CONNECT=zookeeper:2181

# ===== 监控配置（可选）=====
# PROMETHEUS_ENABLED=false
# STATSD_ENABLED=false
# STATSD_ADDRESS=host.docker.internal:8125
# STATSD_AGENT=datadog

# ===== 日志收集（可选）=====
# LOG_BUGSNAG_ENABLED=false
# LOG_BUGSNAG_KEY=

# ===== 健康检查配置 =====
HEALTH_BLOCK_DIFF_THRESHOLD=30     # 区块差异阈值
HEALTH_TIME_DIFF_THRESHOLD=60      # 时间差异阈值（秒）

